{"title": "Vision transformer", "page_id": 68212199, "revision_id": 1146877500, "revision_timestamp": "2023-03-27T13:56:55Z", "content": "{{Short description|Machine learning algorithm for vision processing}}\nA '''Vision Transformer''' ('''ViT''') is a [[Transformer (machine learning model)|transformer]] that is targeted at vision processing tasks such as [[image recognition]].<ref name=\":0\">{{Cite web|last=Sarkar|first=Arjun|date=2021-05-20|title=Are Transformers better than CNN's at Image Recognition?|url=https://towardsdatascience.com/are-transformers-better-than-cnns-at-image-recognition-ced60ccc7c8|access-date=2021-07-11|website=Medium|language=en}}</ref>\n\n== Vision Transformers ==\n[[File:Vision Transformer.gif|thumb|450x450px|Vision Transformer Architecture for Image Classification]]\nTransformers found their initial applications in [[natural language processing]] (NLP) tasks, as demonstrated by [[language models]] such as [[BERT (language model)|BERT]] and [[GPT-3]]. By contrast the typical image processing system uses a [[convolutional neural network]] (CNN). Well-known projects include Xception, [[Residual neural network|ResNet]], EfficientNet,<ref>{{Cite arXiv |last1=Tan|first1=Mingxing|last2=Le|first2=Quoc V.|date=23 June 2021|title=EfficientNet V2: Smaller Models and Faster Training|class=cs.CV|eprint=2104.00298 <!-- unsupported parameters |url=https://arxiv.org/pdf/2104.00298.pdf|url-status=live --> }}</ref> DenseNet,<ref>{{Cite arXiv |last1=Huang|first1=Gao|last2=Liu|first2=Zhuang|last3=van der Maaten|first3=Laurens|last4=Q. Weinberger|first4=Kilian|date= 28 Jan 2018|title=Densely Connected Convolutional Networks <!-- unsupported parameter |arxiv=1608.06993 --> |class=cs.CV|eprint=1608.06993}}</ref> and Inception.<ref name=\":0\" />\n\nTransformers measure the relationships between pairs of input tokens (words in the case of text strings), termed [[Attention (machine learning)|attention]]. The cost is quadratic in the number of tokens. For images, the basic unit of analysis is the [[pixel]]. However, computing relationships for every pixel pair in a typical image is prohibitive in terms of memory and computation. Instead, ViT computes relationships among pixels in various small sections of the image (e.g., 16x16 pixels), at a drastically reduced cost. The sections (with positional embeddings) are placed in a sequence. The embeddings are learnable vectors. Each section is arranged into a linear sequence and multiplied by the embedding matrix. The result, with the position embedding is fed to the transformer.<ref name=\":0\" />\n\nAs in the case of [[BERT (language model)|BERT]], a fundamental role in classification tasks is played by the class token. A special token that is used as the only input of the final [[Multilayer perceptron|MLP]] Head as it has been influenced by all the others.\n\nThe architecture for image classification is the most common and uses only the Transformer Encoder in order to transform the various input tokens. However, there are also other applications in which the decoder part of the traditional Transformer Architecture is also used.\n\n== History ==\nThe general transformer architecture was initially introduced in 2017 in the well-known paper \"Attention is All You Need\".<ref>{{cite arXiv|last1=Vaswani|first1=Ashish|last2=Shazeer|first2=Noam|last3=Parmar|first3=Niki|last4=Uszkoreit|first4=Jakob|last5=Jones|first5=Llion|last6=Gomez|first6=Aidan N.|last7=Kaiser|first7=Lukasz|last8=Polosukhin|first8=Illia|date=2017-12-05|title=Attention Is All You Need|class=cs.CL |eprint=1706.03762}}</ref> They have spread widely in the field of Natural Language Processing and have become one of the most widely used and promising neural network architectures in the field.\n\nIn 2019 the Vision Transformer architecture for processing images without the need of any convolutions was proposed by Cordonnier et al.<ref>{{cite arXiv|eprint=1911.03584|last1=Cordonnier |first1=Jean-Baptiste |last2=Loukas |first2=Andreas |last3=Jaggi |first3=Martin |title=On the Relationship between Self-Attention and Convolutional Layers |year=2019 |class=cs.LG }}</ref>, and later empirically evaluated more extensively in the well-known paper \"An image is worth 16x16 words\".<ref>{{cite arXiv|last1=Dosovitskiy|first1=Alexey|last2=Beyer|first2=Lucas|last3=Kolesnikov|first3=Alexander|last4=Weissenborn|first4=Dirk|last5=Zhai|first5=Xiaohua|last6=Unterthiner|first6=Thomas|last7=Dehghani|first7=Mostafa|last8=Minderer|first8=Matthias|last9=Heigold|first9=Georg|last10=Gelly|first10=Sylvain|last11=Uszkoreit|first11=Jakob|date=2021-06-03|title=An Image is Worth 16x16 Words: Transformers for Image Recognition at Scale|class=cs.CV |eprint=2010.11929}}</ref> The idea is basically to break down input images as a series of patches which, once transformed into vectors, are seen as words in a normal transformer.\n\nIf in the field of Natural Language Processing the mechanism of attention of the Transformers tried to capture the relationships between different words of the text to be analysed, in Computer Vision the Vision Transformers try instead to capture the relationships between different portions of an image.\n\nIn 2021 a pure transformer model demonstrated better performance and greater efficiency than CNNs on image classification.<ref name=\":0\" />\n\nA study in June 2021 added a transformer backend to Resnet, which dramatically reduced costs and increased accuracy.<ref name=\":1\" /><ref>{{Cite arXiv|eprint=2006.03677|class=cs.CV|first1=Bichen|last1=Wu|first2=Chenfeng|last2=Xu|title=Visual Transformers: Token-based Image Representation and Processing for Computer Vision <!-- unsupported parameters |url=https://arxiv.org/pdf/2006.03677.pdf |url-status=live -->|last3=Dai|first8=Joseph|year=2020|last10=Vajda|first10=Peter|first9=Kurt|last9=Keutzer|last8=Gonzalez|first3=Xiaoliang|first7=Tomizuka|first6=Zhicheng|last6=Yan|first5=Peizhao|last5=Zhang|first4=Alvin|last4=Wan|last7=Masayoshi}}</ref><ref name=\":2\" />\n\nIn the same year, some important variants of the Vision Transformers were proposed. These variants are mainly intended to be more efficient, more accurate or better suited to a specific domain. Among the most relevant is the Swin Transformer,<ref>{{cite arXiv|last1=Liu|first1=Ze|last2=Lin|first2=Yutong|last3=Cao|first3=Yue|last4=Hu|first4=Han|last5=Wei|first5=Yixuan|last6=Zhang|first6=Zheng|last7=Lin|first7=Stephen|last8=Guo|first8=Baining|date=2021-03-25|title=Swin Transformer: Hierarchical Vision Transformer using Shifted Windows|class=cs.CV |eprint=2103.14030|language=en}}</ref> which through some modifications to the attention mechanism and a multi-stage approach achieved state-of-the-art results on some object detection datasets such as [[COCO (dataset)|COCO]]. Another interesting variant is the TimeSformer, designed for video understanding tasks and able to capture spatial and temporal information through the use of divided space-time attention.<ref>{{cite arXiv|last1=Bertasius|first1=Gedas|last2=Wang|first2=Heng|last3=Torresani|first3=Lorenzo|date=2021-02-09|title=Is Space-Time Attention All You Need for Video Understanding?|class=cs.CV |eprint=2102.05095|language=en}}</ref><ref>{{cite web|last=Coccomini|first=Davide|date=2021-03-31|title=On Transformers, TimeSformers, and Attention. An exciting revolution from text to videos|url=https://towardsdatascience.com/transformers-an-exciting-revolution-from-text-to-videos-dc70a15e617b|url-access=subscription|website=Towards Data Science}}</ref>\n\nVision Transformers were also able to get out of the lab and into one of the most important fields of Computer Vision, [[autonomous driving]]. \n\n== Comparison with Convolutional Neural Networks ==\nViT performance depends on decisions including that of the optimizer, dataset-specific [[Hyperparameter (machine learning)|hyperparameters]], and network depth. CNN are much easier to optimize.\n\nA variation on a pure transformer is to marry a transformer to a CNN stem/front end. A typical ViT stem uses a 16x16 convolution with a 16 stride. By contrast a 3x3 convolution with stride 2, increases stability and also improves accuracy.<ref name=\":2\">{{cite arXiv|last1=Xiao|first1=Tete|last2=Singh|first2=Mannat|last3=Mintun|first3=Eric|last4=Darrell|first4=Trevor|last5=Doll\u00e1r|first5=Piotr|last6=Girshick|first6=Ross|date=2021-06-28|title=Early Convolutions Help Transformers See Better|class=cs.CV|eprint=2106.14881}}</ref>\n\nThe CNN translates from the basic pixel level to a feature map. A tokenizer translates the feature map into a series of tokens that are then fed into the transformer, which applies the attention mechanism to produce a series of output tokens. Finally, a projector reconnects the output tokens to the feature map. The latter allows the analysis to exploit potentially significant pixel-level details. This drastically reduces the number of tokens that need to be analyzed, reducing costs accordingly.<ref name=\":1\">{{Cite web|last=Synced|date=2020-06-12|title=Facebook and UC Berkeley Boost CV Performance and Lower Compute Cost With Visual Transformers|url=https://medium.com/syncedreview/facebook-and-uc-berkeley-boost-cv-performance-and-lower-compute-cost-with-visual-transformers-c019823f0561|access-date=2021-07-11|website=Medium|language=en}}</ref>\n\nThe differences between CNNs and Vision Transformers are many and lie mainly in their architectural differences.\n\nIn fact, CNNs achieve excellent results even with training based on data volumes that are not as large as those required by Vision Transformers.\n\nThis different behaviour seems to derive from the presence in the CNNs of some [[Inductive bias|inductive biases]] that can be somehow exploited by these networks to grasp more quickly the particularities of the analysed images even if, on the other hand, they end up limiting them making it more complex to grasp global relations.<ref>{{cite arXiv|last1=Raghu|first1=Maithra|last2=Unterthiner|first2=Thomas|last3=Kornblith|first3=Simon|last4=Zhang|first4=Chiyuan|last5=Dosovitskiy|first5=Alexey|date=2021-08-19|title=Do Vision Transformers See Like Convolutional Neural Networks?|class=cs.CV |eprint=2108.08810}}</ref><ref>{{cite web|last=Coccomini|first=Davide|date=2021-07-24|title=Vision Transformers or Convolutional Neural Networks? Both!|url=https://towardsdatascience.com/vision-transformers-or-convolutional-neural-networks-both-de1a2c3c62e4|url-access=subscription|website=Towards Data Science}}</ref>\n\nOn the other hand, the Vision Transformers are free from these biases which leads them to be able to capture also global and wider range relations but at the cost of a more onerous training in terms of data.\n\nVision Transformers also proved to be much more robust to input image distortions such as adversarial patches or permutations.<ref>{{cite arXiv|last1=Naseer|first1=Muzammal|last2=Ranasinghe|first2=Kanchana|last3=Khan|first3=Salman|last4=Hayat|first4=Munawar|last5=Khan|first5=Fahad Shahbaz|last6=Yang|first6=Ming-Hsuan|date=2021-05-21|title=Intriguing Properties of Vision Transformers|class=cs.CV |eprint=2105.10497|language=en}}</ref>\n\nHowever, choosing one architecture over another is not always the wisest choice, and excellent results have been obtained in several Computer Vision tasks through hybrid architectures combining convolutional layers with Vision Transformers.<ref>{{cite arXiv|last1=Dai|first1=Zihang|last2=Liu|first2=Hanxiao|last3=Le|first3=Quoc V.|last4=Tan|first4=Mingxing|date=2021-06-09|title=CoAtNet: Marrying Convolution and Attention for All Data Sizes|class=cs.CV |eprint=2106.04803|language=en}}</ref><ref>{{cite arXiv|last1=Wu|first1=Haiping|last2=Xiao|first2=Bin|last3=Codella|first3=Noel|last4=Liu|first4=Mengchen|last5=Dai|first5=Xiyang|last6=Yuan|first6=Lu|last7=Zhang|first7=Lei|date=2021-03-29|title=CvT: Introducing Convolutions to Vision Transformers|class=cs.CV |eprint=2103.15808|language=en}}</ref><ref>{{cite book|last1=Coccomini|first1=Davide|last2=Messina|first2=Nicola|last3=Gennaro|first3=Claudio|last4=Falchi|first4=Fabrizio|title=Image Analysis and Processing \u2013 ICIAP 2022|chapter=Combining Efficient ''Net'' and Vision Transformers for Video Deepfake Detection |series=Lecture Notes in Computer Science |year=2022 |volume=13233 |pages=219\u2013229 |doi=10.1007/978-3-031-06433-3_19 |arxiv=2107.02612|isbn=978-3-031-06432-6 |s2cid=235742764 |language=en}}</ref>\n\n== The Role of Self-Supervised Learning ==\nThe considerable need for data during the training phase has made it essential to find alternative methods to train these models,<ref>{{cite web|last=Coccomini|first=Davide|date=2021-07-24|title=Self-Supervised Learning in Vision Transformers|url=https://towardsdatascience.com/self-supervised-learning-in-vision-transformers-30ff9be928c|url-access=subscription|website=Towards Data Science}}</ref> and a central role is now played by [[Self-supervised learning|self-supervised methods]]. Using these approaches, it is possible to train a neural network in an almost autonomous way, allowing it to deduce the peculiarities of a specific problem without having to build a large dataset or provide it with accurately assigned labels. Being able to train a Vision Transformer without having to have a huge vision dataset at its disposal could be the key to the widespread dissemination of this promising new architecture.\n\n== Applications ==\nVision Transformers have been used in many Computer Vision tasks with excellent results and in some cases even state-of-the-art.\n\nAmong the most relevant areas of application are:\n\n* [[Image classification|Image Classification]]\n*[[Object detection|Object Detection]]\n* [[Deepfake|Video Deepfake Detection]]\n* [[Image segmentation]]\n* [[Anomaly detection]]\n* [[Image Synthesis]]\n* [[Cluster analysis]]\n*[[Autonomous driving|Autonomous Driving]]\n\n== Implementations ==\nThere are many implementations of Vision Transformers and its variants available in open source online. The main versions of this architecture have been implemented in [[PyTorch]]<ref>{{GitHub|lucidrains/vit-pytorch}}</ref> but implementations have also been made available for [[TensorFlow]].<ref>{{cite web|last=Salama|first=Khalid|date=2021-01-18|title=Image classification with Vision Transformer|url=https://keras.io/examples/vision/image_classification_with_vision_transformer/|website=keras.io}}</ref>\n\n== See also ==\n\n* [[Transformer (machine learning model)]]\n* [[Attention (machine learning)]]\n* [[Perceiver]]\n* [[Deep learning]]\n* [[PyTorch]]\n* [[TensorFlow]]\n\n== References ==\n{{Reflist}}\n\n== External links ==\n\n*{{Cite web|last=Igarashi|first=Yoshiyuki|date=2021-02-04|title=Are You Ready for Vision Transformer (ViT)?|url=https://towardsdatascience.com/are-you-ready-for-vision-transformer-vit-c9e11862c539|url-access=subscription|access-date=2021-07-11|website=Medium|language=en}}\n*{{cite web|last=Coccomini|first=Davide|date=2021-05-03|url=https://towardsdatascience.com/on-dino-self-distillation-with-no-labels-c29e9365e382|url-access=subscription|title=On DINO, Self-Distillation with no labels|website=Towards Data Science|access-date=2021-10-03}}\n\n[[Category:Neural networks]]\n[[Category:Image processing]]"}