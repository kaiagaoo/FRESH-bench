{"title": "Llama (language model)", "page_id": 73306787, "revision_id": 1192563842, "revision_timestamp": "2023-12-30T01:50:45Z", "content": "{{short description|Large language model by Meta AI}}\n{{For|the animal|Llama}}\n{{Distinguish|LaMDA}}\n{{other uses|Llama (disambiguation)}}\n'''LLaMA''' ('''Large Language Model Meta AI''') is a family of [[large language model|large language models]] (LLMs), released by [[Meta AI]] starting in February 2023. \n\nFor the first version of LLaMA, four model sizes were trained: 7, 13, 33 and 65 billion parameters. LLaMA's developers reported that the 13B parameter model's performance on most [[natural language processing|NLP]] benchmarks exceeded that of the much larger [[GPT-3]] (with 175B parameters) and that the largest model was competitive with state of the art models such as [[PaLM]] and [[Chinchilla AI|Chinchilla]].<ref name=\"l1arxiv\" /> Whereas the most powerful LLMs have generally been accessible only through limited [[API]]s (if at all), Meta released LLaMA's model weights to the research community under a noncommercial license.<ref name=\"blog\" /> Within a week of LLaMA's release, its weights were [[internet leak|leaked]] to the public on [[4chan]] via [[BitTorrent]].<ref name=\"verge-leak\" />\n\nIn July 2023, Meta released several models as Llama 2, using 7, 13 and 70 billion parameters.\n\n==LLaMA-2==\nOn July 18, 2023, in partnership with [[Microsoft]], Meta announced LLaMA-2, the next generation of LLaMA. Meta trained and released LLaMA-2 in three model sizes: 7, 13, and 70 billion parameters.<ref>{{cite web |title=Meta and Microsoft Introduce the Next Generation of LLaMA |url=https://about.fb.com/news/2023/07/llama-2/ |website=Meta |access-date=21 July 2023 |date=18 July 2023}}</ref> The model architecture remains largely unchanged from that of LLaMA-1 models, but 40% more data was used to train the foundational models.<ref name=\"l2arxiv\">{{cite arXiv|last1=Touvron |first1=Hugo|last2=Martin |first2=Louis |title=LLaMA-2: Open Foundation and Fine-Tuned Chat Models|date=18 Jul 2023|eprint=2307.09288|class=cs.CL|display-authors=etal}}</ref> The accompanying preprint<ref name=\"l2arxiv\"/> also mentions a model with 34B parameters that might be released in the future upon satisfying safety targets.\n\nLLaMA-2 includes both foundational models and models fine-tuned for dialog, called LLaMA-2 Chat. In further departure from LLaMA-1, all models are released with weights, and are free for many commercial use cases. However, due to some remaining restrictions, the description of LLaMA as [[open source]] has been disputed by the [[Open Source Initiative]] (known for maintaining the [[The Open Source Definition|''Open Source Definition'']]).<ref>{{Cite web |last=Edwards |first=Benj |date=2023-07-18 |title=Meta launches LLaMA-2, a source-available AI model that allows commercial applications [Updated] |url=https://arstechnica.com/information-technology/2023/07/meta-launches-llama-2-an-open-source-ai-model-that-allows-commercial-applications/ |access-date=2023-08-08 |website=Ars Technica |language=en-us}}</ref>\n\nIn November 2023, research conducted by Patronus AI, an artificial intelligence startup company, compared performance of LLaMA-2, [[OpenAI]]'s [[GPT-4]] and GPT-4-Turbo, and [[Anthropic]]'s Claude2 on two versions of a 150-question test about information in [[SEC filing]]s (e.g. [[Form 10-K]], [[Form 10-Q]], [[Form 8-K]], [[earnings]] reports, [[earnings call]] transcripts) submitted by [[Public company|public companies]] to the [[U.S. Securities and Exchange Commission|agency]] where one version of the test required the generative AI models to use a retrieval system to locate the specific SEC filing to answer the questions while the other version provided the specific SEC filing to the models to answer the question (i.e. in a long context window). On the retrieval system version, GPT-4-Turbo and LLaMA-2 both failed to produce correct answers to 81% of the questions, while on the long context window version, GPT-4-Turbo and Claude-2 failed to produce correct answers to 21% and 24% of the questions respectively.<ref>{{cite news|last=Leswing|first=Kif|date=December 19, 2023|title=GPT and other AI models can't analyze an SEC filing, researchers find|publisher=CNBC|url=https://www.cnbc.com/2023/12/19/gpt-and-other-ai-models-cant-analyze-an-sec-filing-researchers-find.html|access-date=December 19, 2023}}</ref><ref>{{cite press release|title=Patronus AI Launches Industry-first LLM Benchmark for Finance to Address Hallucinations|date=November 16, 2023|publisher=[[PR Newswire]]|url=https://www.prnewswire.com/news-releases/patronus-ai-launches-industry-first-llm-benchmark-for-finance-to-address-hallucinations-301990858.html|access-date=December 19, 2023}}</ref>\n\n==Architecture and training==\n{{Quote box\n| title = \"A conversation between the sun and pluto\"\n| quote = Sun: Hey Pluto, what\u2019s up?<br/>\nPluto: Not much. Just hanging out here at the edge of the solar system.<br/>\nSun: Yeah, I\u2019ve been meaning to talk to you about that. You\u2019re not a planet anymore.<br/>\nPluto: What? Come on, man. That\u2019s not fair.<br/>\nSun: I\u2019m sorry, but it\u2019s true. You just don\u2019t meet the criteria anymore.<br/>\nPluto: This is bulls**t! I\u2019ve been a planet for over 70 years!<br/>\nSun: Things change, Pluto. You\u2019ve just got to accept it.<br/>\nPluto: F**k you, Sun! F**k you and your stupid solar system!<br/>\n| source = \u2013 Output of 65 billion parameter LLaMA model after [[instruction tuning]] given the prompt \"Write a conversation between the sun and pluto\"<ref name=l1arxiv/>\n| align = right\n| width = 350px\n}}\n\n=== Architecture ===\nLLaMA uses the [[transformer (machine learning)|transformer]] architecture, the standard architecture for language modeling since 2018. \n\nThere are minor architectural differences. Compared to GPT-3, LLaMA \n\n* uses SwiGLU<ref>{{Cite arXiv |last=Shazeer |first=Noam |date=2020-02-01 |title=GLU Variants Improve Transformer  |class=cs.CL |eprint=2104.09864}}</ref> [[activation function]] instead of ReLU;\n* uses rotary positional embeddings<ref>{{Cite arXiv |last1=Su |first1=Jianlin |last2=Lu |first2=Yu |last3=Pan |first3=Shengfeng |last4=Murtadha |first4=Ahmed |last5=Wen |first5=Bo |last6=Liu |first6=Yunfeng |date=2021-04-01 |title=RoFormer: Enhanced Transformer with Rotary Position Embedding  |class=cs.CL |eprint=2104.09864}}</ref> instead of absolute positional embedding;\n* uses root-mean-squared layer-normalization<ref>{{Cite arXiv|last1=Zhang |first1=Biao |last2=Sennrich |first2=Rico |date=2019-10-01 |title=Root Mean Square Layer Normalization |class=cs.LG |eprint=1910.07467}}</ref> instead of standard layer-normalization.<ref>{{Cite arXiv|last1=Lei Ba |first1=Jimmy |last2=Kiros |first2=Jamie Ryan |last3=Hinton |first3=Geoffrey E. |date=2016-07-01 |title=Layer Normalization |class=stat.ML |eprint=1607.06450}}</ref>\n* increases context length from 2K (Llama 1) tokens to 4K (Llama 2) tokens between.\n\n=== Training datasets ===\nLLaMA's developers focused their effort on scaling the model's performance by increasing the volume of training data, rather than the number of parameters, reasoning that the dominating cost for LLMs is from doing inference on the trained model rather than the computational cost of the training process. \n\n'''LLaMA 1''' foundational models were trained on a data set with 1.4 trillion tokens, drawn from publicly available data sources, including:<ref name=\"l1arxiv\" />\n* Webpages scraped by [[CommonCrawl]]\n* Open source repositories of source code from [[GitHub]]\n* [[Wikipedia]] in 20 different languages\n* [[Public domain]] books from [[Project Gutenberg]]\n* The [[LaTeX]] source code for scientific papers uploaded to [[ArXiv]]\n* Questions and answers from [[Stack Exchange]] websites\n\n'''Llama 2''' foundational models were trained on a data set with 2 trillion tokens. This data set was curated to remove Web sites that often disclose personal data of people. It also upsamples sources considered trustworthy.<ref name=\"l2arxiv\"/> Llama 2 - Chat was additionally fine-tuned on 27,540 prompt-response pairs created for this project, which performed better than larger but lower-quality third-party datasets. For AI alignment, reinforcement learning with human feedback (RLHF) was used with a combination of 1,418,091 Meta examples and seven smaller datasets. The average dialog depth was 3.9 in the Meta examples, 3.0 for Anthropic Helpful and Anthropic Harmless sets, and 1.0 for five other sets, including OpenAI Summarize, StackExchange, etc.\n\n=== Fine-tuning ===\n\nLlama 1 models are only available as foundational models with self-supervised learning and without fine-tuning. Llama 2 \u2013 Chat models were derived from foundational Llama 2 models. Unlike [[GPT-4]] which increased context length during fine-tuning, Llama 2 and Llama 2 - Chat have the same context length of 4K tokens. Supervised fine-tuning used an autoregressive loss function with token loss on user prompts zeroed out. Batch size was 64.\n\nFor [[AI alignment]], human annotators wrote prompts and then compared two model outputs (a binary protocol), giving confidence levels and separate safety labels with veto power. Two separate reward models were trained from these preferences for safety and helpfulness using [[Reinforcement learning from human feedback]] (RLHF). A major technical contribution is the departure from the exclusive use of [[Proximal Policy Optimization]] (PPO) for RLHF \u2013 a new technique based on [[Rejection sampling]] was used, followed by PPO.\n\nMulti-turn consistency in dialogs was targeted for improvement, to make sure that \"system messages\" (initial instructions, such as \"speak in French\" and \"act like Napoleon\") are respected during the dialog. This was accomplished using the new \"Ghost attention\" technique during training, that concatenates relevant instructions to each new user message but zeros out the loss function for tokens in the prompt (earlier parts of the dialog).\n\n==Release and leak==\nLLaMA was announced on February 23, 2023, via a blog post and a paper describing the [[Training, validation, and test data sets|model's training]], architecture, and performance.<ref name=l1arxiv/><ref name=blog/> The inference code used to run the model was publicly released under the open-source [[GPL 3]] license.<ref name=repo/> Access to the model's weights was managed by an application process, with access to be granted \"on a case-by-case basis to academic researchers; those affiliated with organizations in government, civil society, and academia; and industry research laboratories around the world\".<ref name=blog/>\n\nOn March 2, 2023, a torrent containing LLaMA's weights was uploaded, with a link to the torrent shared on the [[4chan]] imageboard and subsequently spreading through online AI communities.<ref name=verge-leak/> That same day, a pull request on the main LLaMA repository was opened, requesting to add the [[magnet link]] to the official documentation.<ref name=India-leak>{{cite news |last1=VK |first1=Anirudh |title=Meta's LLaMA Leaked to the Public, Thanks To 4chan |url=https://analyticsindiamag.com/metas-llama-leaked-to-the-public-thanks-to-4chan/ |access-date=17 March 2023 |work=Analytics India Magazine |date=6 March 2023}}</ref><ref name=\"CKing\"/> On March 4, a pull request was opened to add links to [[HuggingFace]] repositories containing the model.<ref>{{cite web |title=Download weights from huggingface to help us save bandwith by Jainam213 \u00b7 Pull Request #109 \u00b7 facebookresearch/llama |url=https://github.com/facebookresearch/llama/pull/109 |website=GitHub |access-date=17 March 2023 |language=en}}</ref><ref name=India-leak/> On March 6, Meta filed [[takedown request]]s to remove the HuggingFace repositories linked in the pull request, characterizing it as \"unauthorized distribution\" of the model. HuggingFace complied with the requests.<ref>{{cite news |last1=Cox |first1=Joseph |title=Facebook's Powerful Large Language Model Leaks Online |url=https://www.vice.com/en/article/xgwqgw/facebooks-powerful-large-language-model-leaks-online-4chan-llama |access-date=17 March 2023 |work=Vice |date=7 March 2023 |language=en}}</ref> On March 20, Meta filed a [[DMCA]] takedown request for copyright infringement against a repository containing a script that downloaded LLaMA from a mirror, and GitHub complied the next day.<ref>{{cite web |author1=OpSec Online LLC |title=github/dmca - Notice of Claimed Infringement via Email |url=https://github.com/github/dmca/blob/master/2023/03/2023-03-21-meta.md |publisher=GitHub |access-date=25 March 2023 |date=21 March 2023}}</ref> As of March 25, Facebook has not responded to the pull request containing the magnet link.<ref name=\"CKing\">{{cite web |title=Save bandwidth by using a torrent to distribute more efficiently by ChristopherKing42 \u00b7 Pull Request #73 \u00b7 facebookresearch/llama |url=https://github.com/facebookresearch/llama/pull/73 |website=GitHub |access-date=25 March 2023 |language=en}}</ref>\n\nReactions to the leak varied. Some speculated that the model would be used for malicious purposes, such as more sophisticated [[spamming|spam]]. Some have celebrated the model's accessibility, as well as the fact that smaller versions of the model can be run relatively cheaply, suggesting that this will promote the flourishing of additional research developments.<ref name=verge-leak/> Multiple commentators, such as [[Simon Willison]], compared LLaMA to [[Stable Diffusion]], a [[text-to-image model]] which, unlike comparably sophisticated models which preceded it, was openly distributed, leading to a rapid proliferation of associated tools, techniques, and software.<ref name=verge-leak/><ref name=willison/>\n\n==Dataset reproduction==\nOn April 17, 2023, TogetherAI launched a project named RedPajama to reproduce and distribute an [[open source]] version of the LLaMA dataset.<ref name=red-pajama/> The dataset has approximately 1.2 trillion tokens and is publicly available for download.<ref name=red-pajama-download/>\n\n==Applications==\nThe [[Stanford University]] Institute for [[Human-centered computing|Human-Centered Artificial Intelligence]] (HAI) Center for Research on Foundation Models (CRFM) released Alpaca, a training recipe based on the LLaMA 7B model that uses the \"Self-Instruct\" method of [[instruction tuning]] to acquire capabilities comparable to the OpenAI GPT-3 series text-davinci-003 model at a modest cost.<ref>{{cite web |url=https://crfm.stanford.edu/2023/03/13/alpaca.html |title=Alpaca: A Strong, Replicable Instruction-Following Model |date=13 March 2023 |first1=Rohan |last1=Taori |first2=Ishaan |last2=Gulrajani |first3=Tianyi |last3=Zhang |first4=Yann |last4=Dubois |first5=Xuechen |last5=Li |first6=Carlos |last6=Guestrin |first7=Percy |last7=Liang |first8=Tatsunori B. |last8=Hashimoto |website= |publisher=Stanford Center for Research on Foundation Models |access-date=}}</ref><ref>{{cite arXiv | eprint=2212.10560 | last1=Wang | first1=Yizhong | last2=Kordi | first2=Yeganeh | last3=Mishra | first3=Swaroop | last4=Liu | first4=Alisa | last5=Smith | first5=Noah A. | last6=Khashabi | first6=Daniel | last7=Hajishirzi | first7=Hannaneh | title=Self-Instruct: Aligning Language Models with Self-Generated Instructions | year=2022 | class=cs.CL }}</ref> Multiple open source projects are{{When|date=August 2023}} continuing this work of finetuning LLaMA with Alpaca dataset.<ref name=repo-alpaca/>\n\n==References==\n{{reflist|refs=\n<ref name=blog>{{cite web\n|work=Meta AI\n|title=Introducing LLaMA: A foundational, 65-billion-parameter large language model\n|date=24 February 2023\n|url=https://ai.facebook.com/blog/large-language-model-llama-meta-ai/\n}}</ref>\n<ref name=l1arxiv>{{cite arXiv\n|eprint=2302.13971\n|last1=Touvron\n|first1=Hugo\n|last2=Lavril\n|first2=Thibaut\n|last3=Izacard\n|first3=Gautier\n|last4=Martinet\n|first4=Xavier\n|last5=Lachaux\n|first5=Marie-Anne\n|last6=Lacroix\n|first6=Timoth\u00e9e\n|last7=Rozi\u00e8re\n|first7=Baptiste\n|last8=Goyal\n|first8=Naman\n|last9=Hambro\n|first9=Eric\n|last10=Azhar\n|first10=Faisal\n|last11=Rodriguez\n|first11=Aurelien\n|last12=Joulin\n|first12=Armand\n|last13=Grave\n|first13=Edouard\n|last14=Lample\n|first14=Guillaume\n|title=LLaMA: Open and Efficient Foundation Language Models\n|year=2023\n|class=cs.CL\n}}</ref>\n<ref name=verge-leak>{{cite web\n|work=The Verge\n|title=Meta's powerful AI language model has leaked online \u2014 what happens now?\n|last=Vincent|first=James\n|date=8 March 2023\n|url=https://www.theverge.com/2023/3/8/23629362/meta-ai-language-model-llama-leak-online-misuse\n}}</ref>\n<ref name=repo>{{cite web\n|title=llama\n|work=GitHub\n|access-date=16 March 2023\n|url=https://github.com/facebookresearch/llama\n}}</ref>\n<ref name=willison>{{cite web\n|work=Simon Willison's Weblog\n|last=Willison|first=Simon\n|title=Large language models are having their Stable Diffusion moment\n|date=11 March 2023\n|url=https://simonwillison.net/2023/Mar/11/llama/\n}}</ref> <!-- [[WP:SPS]] by established subject matter expert -->\n<ref name=repo-alpaca>{{cite web\n|title=alpaca-lora\n|work=GitHub\n|access-date=5 April 2023\n|url=https://github.com/tloen/alpaca-lora\n}}</ref>\n<ref name=red-pajama>{{cite web \n|title=RedPajama-Data: An Open Source Recipe to Reproduce LLaMA training dataset\n|url=https://github.com/togethercomputer/RedPajama-Data\n|website=GitHub\n|publisher=Together \n|access-date=4 May 2023}}</ref>\n<ref name=red-pajama-download>{{cite web \n|title=RedPajama-Data-1T\n|url=https://huggingface.co/datasets/togethercomputer/RedPajama-Data-1T\n|website=Hugging Face\n|publisher=Together \n|access-date=4 May 2023}}</ref>\n}}\n\n== Further reading ==\n{{refbegin}}\n* {{Cite web |last1=Huang |first1=Kalley |last2=O'Regan |first2=Sylvia Varnham |date=September 5, 2023 |title=Inside Meta's AI Drama: Internal Feuds Over Compute Power |url=https://www.theinformation.com/articles/inside-metas-ai-drama-internal-feuds-over-compute-power |url-access=limited |url-status=live |archive-url=https://web.archive.org/web/20230905174145/https://www.theinformation.com/articles/inside-metas-ai-drama-internal-feuds-over-compute-power |archive-date=September 5, 2023 |access-date=September 6, 2023 |website=[[The Information (website)|The Information]]}}\n{{refend}}\n\n[[Category:2023 software]]\n[[Category:Internet leaks]]\n[[Category:Large language models]]\n[[Category:Meta Platforms]]"}