{"title": "BERT (language model)", "page_id": 62026514, "revision_id": 1266101006, "revision_timestamp": "2024-12-30T03:11:27Z", "content": "{{short description|Series of language models developed by Google AI}}\n{{Infobox software\n| name = Bidirectional Encoder Representations from Transformers (BERT)\n| logo = \n| screenshot = \n| screenshot size = \n| caption = \n| author = [[Google AI]]\n| developer = \n| released = October 31, 2018\n| latest release version = \n| latest release date = March 11, 2020\n| repo = {{URL|https://github.com/google-research/bert}}\n| programming language = \n| operating system = \n| replaces = \n| replaced_by = \n| genre = {{ indented plainlist |\n*[[Large language model]]\n*[[Transformer (deep learning architecture)]]\n*[[Foundation model]]\n}}\n| license = [[Apache 2.0]]\n| website = \n}}\n{{Use mdy dates|date=November 2023}} {{Use American English|date=November 2023}}\n'''Bidirectional encoder representations from transformers''' ('''BERT''') is a [[language model]] introduced in October 2018 by researchers at [[Google]].<ref name=\":0\">{{cite arXiv |eprint=1810.04805v2 |class=cs.CL |first1=Jacob |last1=Devlin |first2=Ming-Wei |last2=Chang |last3=Lee |first3=Kenton |last4=Toutanova |first4=Kristina|title=BERT: Pre-training of Deep Bidirectional Transformers for Language Understanding |date=11 October 2018 }}</ref><ref>{{Cite web |date=2 November 2018 |title=Open Sourcing BERT: State-of-the-Art Pre-training for Natural Language Processing |url=http://ai.googleblog.com/2018/11/open-sourcing-bert-state-of-art-pre.html |access-date=2019-11-27 |website=Google AI Blog |language=en}}</ref> It learns to represent text as a sequence of vectors using [[self-supervised learning]]. It uses the [[Transformer (machine learning model)|encoder-only transformer]] architecture. It is notable for its dramatic improvement over previous state-of-the-art models, and as an early example of a [[large language model]]. {{As of|2020}}, BERT is a ubiquitous baseline in [[natural language processing]] (NLP) experiments.<ref name=\":4\">{{Cite journal|last1=Rogers|first1=Anna|last2=Kovaleva|first2=Olga|last3=Rumshisky|first3=Anna|date=2020|title=A Primer in BERTology: What We Know About How BERT Works|url=https://aclanthology.org/2020.tacl-1.54|journal=Transactions of the Association for Computational Linguistics|volume=8|pages=842\u2013866|doi=10.1162/tacl_a_00349|arxiv=2002.12327|s2cid=211532403}}</ref> \n\nBERT is trained by masked token prediction and next sentence prediction. As a result of this training process, BERT learns contextual, [[Latent space|latent representations]] of tokens in their context, similar to [[ELMo]] and [[GPT-2]].<ref name=\":5\">{{Citation |last=Ethayarajh |first=Kawin |title=How Contextual are Contextualized Word Representations? Comparing the Geometry of BERT, ELMo, and GPT-2 Embeddings |date=2019-09-01 |arxiv=1909.00512}}</ref> It found applications for many natural language processing tasks, such as [[coreference resolution]] and [[polysemy]] resolution.<ref>{{Cite web |last=Anderson |first=Dawn |date=2019-11-05 |title=A deep dive into BERT: How BERT launched a rocket into natural language understanding |url=https://searchengineland.com/a-deep-dive-into-bert-how-bert-launched-a-rocket-into-natural-language-understanding-324522 |access-date=2024-08-06 |website=Search Engine Land |language=en}}</ref> It is an evolutionary step over [[ELMo]], and spawned the study of \"BERTology\", which attempts to interpret what is learned by BERT.<ref name=\":4\" />\n\nBERT was originally implemented in the English language at two model sizes, BERT<sub>BASE</sub> (110 million parameters) and BERT<sub>LARGE</sub> (340 million parameters). Both were trained on the Toronto [[BookCorpus]]<ref> name=\"bookcorpus\"{{cite arXiv|last1=Zhu|first1=Yukun|last2=Kiros|first2=Ryan|last3=Zemel|first3=Rich|last4=Salakhutdinov|first4=Ruslan|last5=Urtasun|first5=Raquel|last6=Torralba|first6=Antonio|last7=Fidler|first7=Sanja|date=2015|title=Aligning Books and Movies: Towards Story-Like Visual Explanations by Watching Movies and Reading Books|pages=19\u201327|class=cs.CV|eprint=1506.06724}}</ref> (800M words) and [[English Wikipedia]]  (2,500M words).{{citation needed|date=December 2024}} The weights were released on [[GitHub]].<ref name=\":3\">{{cite web |title=BERT |url=https://github.com/google-research/bert |access-date=28 March 2023 |website=GitHub}}</ref> On March 11, 2020, 24 smaller models were released, the smallest being BERT<sub>TINY</sub> with just 4 million parameters.<ref name=\":3\" />\n\n== Architecture ==\n[[File:BERT_embeddings_01.png|thumb|330x330px|High-level schematic diagram of BERT. It takes in a text, tokenizes it into a sequence of tokens, add in optional special tokens, and apply a Transformer encoder. The hidden states of the last layer can then be used as contextual word embeddings.]]\nBERT is an \"encoder-only\" [[Transformer (machine learning model)|transformer]] architecture. At a high level, BERT consists of 4 modules: \n\n* Tokenizer: This module converts a piece of English text into a sequence of integers (\"tokens\"). \n* [[Embedding]]: This module converts the sequence of tokens into an array of real-valued vectors representing the tokens. It represents the conversion of discrete token types into a lower-dimensional [[Euclidean space]].\n* Encoder: a stack of Transformer blocks with [[Attention (machine learning)|self-attention]], but without causal masking.\n* Task head: This module converts the final representation vectors into one-hot encoded tokens again by producing a predicted probability distribution over the token types. It can be viewed as a simple decoder, decoding the latent representation into token types, or as an \"un-embedding layer\".\n\nThe task head is necessary for pre-training, but it is often unnecessary for so-called \"downstream tasks,\" such as [[question answering]] or [[Sentiment analysis|sentiment classification]]. Instead, one removes the task head and replaces it with a newly initialized module suited for the task, and finetune the new module. The latent vector representation of the model is directly fed into this new module, allowing for sample-efficient [[transfer learning]].<ref name=\":0\" /><ref>{{Citation |last1=Zhang |first1=Tianyi |title=Revisiting Few-sample BERT Fine-tuning |date=2021-03-11 |arxiv=2006.05987 |last2=Wu |first2=Felix |last3=Katiyar |first3=Arzoo |last4=Weinberger |first4=Kilian Q. |last5=Artzi |first5=Yoav}}</ref>\n[[File:BERT_encoder-only_attention.svg|thumb|Encoder-only attention is all-to-all.]]\n\n=== Embedding ===\nThis section describes the embedding used by BERT<sub>BASE</sub>. The other one, BERT<sub>LARGE</sub>, is similar, just larger.\n\nThe tokenizer of BERT is WordPiece, which is a sub-word strategy like [[byte pair encoding]]. Its vocabulary size is 30,000, and any token not appearing in its vocabulary is replaced by <code>[UNK]</code> (\"unknown\"). \n[[File:BERT_input_embeddings.png|thumb|284x284px|The three kinds of embedding used by BERT: token type, position, and segment type.]]\nThe first layer is the embedding layer, which contains three components: token type embeddings, position embeddings, and segment type embeddings. \n\n* Token type: The token type is a standard embedding layer, translating a one-hot vector into a dense vector based on its token type.\n* Position: The position embeddings are based on a token's position in the sequence. BERT uses absolute position embeddings, where each position in sequence is mapped to a real-valued vector. Each dimension of the vector consists of a [[Sine wave|sinusoidal function]] that takes the position in the sequence as input.\n* Segment type: Using a vocabulary of just 0 or 1, this embedding layer produces a dense vector based on whether the token belongs to the first or second text segment in that input. In other words, type-1 tokens are all tokens that appear after the <code>[SEP]</code> special token. All prior tokens are type-0.\n\nThe three embedding vectors are added together representing the initial token representation as a function of these three pieces of information. After embedding, the vector representation is normalized using a [[LayerNorm]] operation, outputting a 768-dimensional vector for each input token. After this, the representation vectors are passed forward through 12 Transformer encoder blocks, and are decoded back to 30,000-dimensional vocabulary space using a basic affine transformation layer.\n\n=== Architectural family ===\nThe encoder stack of BERT has 2 free parameters: <math>L</math>, the number of layers, and <math>H</math>, the '''hidden size'''. There are always <math>H/64</math> self-attention heads, and the feed-forward/filter size is always <math>4H</math>. By varying these two numbers, one obtains an entire family of BERT models.<ref>{{Citation |last1=Turc |first1=Iulia |title=Well-Read Students Learn Better: On the Importance of Pre-training Compact Models |date=2019-09-25 |arxiv=1908.08962 |last2=Chang |first2=Ming-Wei |last3=Lee |first3=Kenton |last4=Toutanova |first4=Kristina}}</ref>\n\nFor BERT\n\n* the '''feed-forward size''' and '''filter size''' are synonymous. Both of them denote the number of dimensions in the middle layer of the feed-forward network.\n* the '''hidden size''' and '''embedding size''' are synonymous. Both of them denote the number of real numbers used to represent a token.\n\nThe notation for encoder stack is written as L/H. For example, BERT<sub>BASE</sub> is written as 12L/768H, BERT<sub>LARGE</sub> as 24L/1024H, and BERT<sub>TINY</sub> as 2L/128H.\n\n== Training ==\n=== Pre-training ===\nBERT was pre-trained simultaneously on two tasks.<ref>{{Cite web |title=Summary of the models \u2014 transformers 3.4.0 documentation |url=https://huggingface.co/transformers/v3.4.0/model_summary.html |access-date=2023-02-16 |website=huggingface.co}}</ref> \n\n==== Masked language modeling ====\n[[File:BERT_masked_language_modelling_task.png|thumb|The masked language modeling task.]]\nIn masked language modeling, 15% of tokens would be randomly selected for masked-prediction task, and the training objective was to predict the masked token given its context. In more detail, the selected token is \n\n* replaced with a <code>[MASK]</code> token with probability 80%,\n* replaced with a random word token with probability 10%,\n* not replaced with probability 10%.\n\nThe reason not all selected tokens are masked is to avoid the dataset shift problem. The dataset shift problem arises when the distribution of inputs seen during training differs significantly from the distribution encountered during inference. A trained BERT model might be applied to word representation (like [[Word2Vec]]), where it would be run over sentences not containing any <code>[MASK]</code> tokens. It is later found that more diverse training objectives are generally better.<ref>{{Citation |last1=Tay |first1=Yi |title=UL2: Unifying Language Learning Paradigms |date=2023-02-28 |arxiv=2205.05131 |last2=Dehghani |first2=Mostafa |last3=Tran |first3=Vinh Q. |last4=Garcia |first4=Xavier |last5=Wei |first5=Jason |last6=Wang |first6=Xuezhi |last7=Chung |first7=Hyung Won |last8=Shakeri |first8=Siamak |last9=Bahri |first9=Dara}}</ref>\n\nAs an illustrative example, consider the sentence \"my dog is cute\". It would first be divided into tokens like \"my<sub>1</sub> dog<sub>2</sub> is<sub>3</sub> cute<sub>4</sub>\". Then a random token in the sentence would be picked. Let it be the 4th one \"cute<sub>4</sub>\". Next, there would be three possibilities:\n\n* with probability 80%, the chosen token is masked, resulting in \"my<sub>1</sub> dog<sub>2</sub> is<sub>3</sub> <code>[MASK]</code><sub>4</sub>\";\n* with probability 10%, the chosen token is replaced by a uniformly sampled random token, such as \"happy\", resulting in \"my<sub>1</sub> dog<sub>2</sub> is<sub>3</sub> happy<sub>4</sub>\";\n* with probability 10%, nothing is done, resulting in \"my<sub>1</sub> dog<sub>2</sub> is<sub>3</sub> cute<sub>4</sub>\".\n\nAfter processing the input text, the model's 4th output vector is passed to its decoder layer, which outputs a probability distribution over its 30,000-dimensional vocabulary space.\n\n==== Next sentence prediction ====\n[[File:BERT_next_sequence_prediction_task.png|thumb|The next sentence prediction task.]]\nGiven two spans of text, the model predicts if these two spans appeared sequentially in the training corpus, outputting either <code>[IsNext]</code> or <code>[NotNext]</code>. The first span starts with a special token <code>[CLS]</code> (for \"classify\"). The two spans are separated by a special token <code>[SEP]</code> (for \"separate\"). After processing the two spans, the 1-st output vector (the vector coding for <code>[CLS]</code>) is passed to a separate neural network for the binary classification into <code>[IsNext]</code> and <code>[NotNext]</code>.\n\n* For example, given \"<code>[CLS]</code> my dog is cute <code>[SEP]</code> he likes playing\" the model should output token <code>[IsNext]</code>.\n* Given \"<code>[CLS]</code> my dog is cute <code>[SEP]</code> how do magnets work\" the model should output token <code>[NotNext]</code>.\n\n=== Fine-tuning ===\n\n{{Gallery\n|title=Finetuned tasks for BERT<ref name=\"zhangetal2024\" />\n|align=center\n|File:BERT on sentiment classification.svg|Sentiment classification|File:BERT on sentence classification.svg|Sentence classification|File:BERT on multiple-choice question-answering.svg|Answering multiple-choice questions|File:BERT on tagging.svg|[[Part-of-speech tagging]]}}\n\nBERT is meant as a general pretrained model for various applications in natural language processing. That is, after pre-training, BERT can be [[fine-tuning (machine learning)|fine-tuned]] with fewer resources on smaller datasets to optimize its performance on specific tasks such as [[Textual entailment|natural language inference]] and [[Document classification|text classification]], and sequence-to-sequence-based language generation tasks such as [[question answering]] and conversational response generation.<ref name=\"zhangetal2024\">{{Cite book |last1=Zhang |first1=Aston |title=Dive into deep learning |last2=Lipton |first2=Zachary |last3=Li |first3=Mu |last4=Smola |first4=Alexander J. |date=2024 |publisher=Cambridge University Press |isbn=978-1-009-38943-3 |location=Cambridge New York Port Melbourne New Delhi Singapore |chapter=11.9. Large-Scale Pretraining with Transformers |chapter-url=https://d2l.ai/chapter_attention-mechanisms-and-transformers/large-pretraining-transformers.html}}</ref>\n\nThe original BERT paper published results demonstrating that a small amount of finetuning (for BERT<sub>LARGE</sub>, 1 hour on 1 Cloud TPU) allowed it to achieved [[State of the art|state-of-the-art]] performance on a number of [[Natural-language understanding|natural language understanding]] tasks:<ref name=\":0\" />\n\n* GLUE ([[General Language Understanding Evaluation]]) task set (consisting of 9 tasks);\n* SQuAD (Stanford Question Answering Dataset<ref>{{Cite arXiv |eprint=1606.05250 |class=cs.CL |first1=Pranav |last1=Rajpurkar |first2=Jian |last2=Zhang |title=SQuAD: 100,000+ Questions for Machine Comprehension of Text |date=2016-10-10 |last3=Lopyrev |first3=Konstantin |last4=Liang |first4=Percy}}</ref>) v1.1 and v2.0;\n* SWAG (Situations With Adversarial Generations<ref>{{Cite arXiv |eprint=1808.05326 |class=cs.CL |first1=Rowan |last1=Zellers |first2=Yonatan |last2=Bisk |title=SWAG: A Large-Scale Adversarial Dataset for Grounded Commonsense Inference |date=2018-08-15 |last3=Schwartz |first3=Roy |last4=Choi |first4=Yejin}}</ref>).\nIn the original paper, all parameters of BERT are finetuned, and recommended that, for downstream applications that are text classifications, the output token at the <code>[CLS]</code> input token is fed into a linear-softmax layer to produce the label outputs.<ref name=\":0\" />\n\nThe original code base defined the final linear layer as a \"pooler layer\", in analogy with [[Pooling layer|global pooling]] in computer vision, even though it simply discards all output tokens except the one corresponding to  <code>[CLS]</code> .<ref>{{Cite web |title=bert/modeling.py at master \u00b7 google-research/bert |url=https://github.com/google-research/bert/blob/master/modeling.py |access-date=2024-09-16 |website=GitHub |language=en}}</ref>\n\n=== Cost ===\nBERT was trained on the [[BookCorpus]] (800M words) and a filtered version of English Wikipedia (2,500M words) without lists, tables, and headers.\n\nTraining BERT<sub>BASE</sub>  on 4 cloud [[Tensor Processing Unit|TPU]] (16 TPU chips total) took 4 days, at an estimated cost of 500 USD.<ref name=\":3\" /> Training BERT<sub>LARGE</sub> on 16 cloud TPU (64 TPU chips total) took 4 days.<ref name=\":0\" />\n\n== Interpretation ==\nLanguage models like ELMo, GPT-2, and BERT, spawned the study of \"BERTology\", which attempts to interpret what is learned by these models. Their performance on these [[Natural-language understanding|natural language understanding]] tasks are not yet well understood.<ref name=\":4\" /><ref name=\":1\">{{Cite book|last1=Kovaleva|first1=Olga|last2=Romanov|first2=Alexey|last3=Rogers|first3=Anna|last4=Rumshisky|first4=Anna|date=November 2019|chapter=Revealing the Dark Secrets of BERT|chapter-url=https://www.aclweb.org/anthology/D19-1445|language=en-us|pages=4364\u20134373|doi=10.18653/v1/D19-1445|title=Proceedings of the 2019 Conference on Empirical Methods in Natural Language Processing and the 9th International Joint Conference on Natural Language Processing (EMNLP-IJCNLP)|s2cid=201645145}}</ref><ref name=\":2\">{{Cite journal|last1=Clark|first1=Kevin|last2=Khandelwal|first2=Urvashi|last3=Levy|first3=Omer|last4=Manning|first4=Christopher D.|date=2019|title=What Does BERT Look at? An Analysis of BERT's Attention|journal=Proceedings of the 2019 ACL Workshop BlackboxNLP: Analyzing and Interpreting Neural Networks for NLP|pages=276\u2013286|location=Stroudsburg, PA, USA|publisher=Association for Computational Linguistics|doi=10.18653/v1/w19-4828|doi-access=free|arxiv=1906.04341}}</ref> Several research publications in 2018 and 2019 focused on investigating the relationship behind BERT's output as a result of carefully chosen input sequences,<ref>{{Cite journal|last1=Khandelwal|first1=Urvashi|last2=He|first2=He|last3=Qi|first3=Peng|last4=Jurafsky|first4=Dan|date=2018|title=Sharp Nearby, Fuzzy Far Away: How Neural Language Models Use Context|journal=Proceedings of the 56th Annual Meeting of the Association for Computational Linguistics (Volume 1: Long Papers)|pages=284\u2013294|location=Stroudsburg, PA, USA|publisher=Association for Computational Linguistics|doi=10.18653/v1/p18-1027|arxiv=1805.04623|s2cid=21700944}}</ref><ref>{{Cite book|last1=Gulordava|first1=Kristina|last2=Bojanowski|first2=Piotr|last3=Grave|first3=Edouard|last4=Linzen|first4=Tal|last5=Baroni|first5=Marco|title=Proceedings of the 2018 Conference of the North American Chapter of the Association for Computational Linguistics: Human Language Technologies, Volume 1 (Long Papers) |chapter=Colorless Green Recurrent Networks Dream Hierarchically |date=2018|pages=1195\u20131205|location=Stroudsburg, PA, USA|publisher=Association for Computational Linguistics|doi=10.18653/v1/n18-1108|arxiv=1803.11138|s2cid=4460159}}</ref> analysis of internal [[Vector space model|vector representations]] through probing classifiers,<ref>{{Cite journal|last1=Giulianelli|first1=Mario|last2=Harding|first2=Jack|last3=Mohnert|first3=Florian|last4=Hupkes|first4=Dieuwke|last5=Zuidema|first5=Willem|date=2018|title=Under the Hood: Using Diagnostic Classifiers to Investigate and Improve how Language Models Track Agreement Information|journal=Proceedings of the 2018 EMNLP Workshop BlackboxNLP: Analyzing and Interpreting Neural Networks for NLP|pages=240\u2013248|location=Stroudsburg, PA, USA|publisher=Association for Computational Linguistics|doi=10.18653/v1/w18-5426|arxiv=1808.08079|s2cid=52090220}}</ref><ref>{{Cite journal|last1=Zhang|first1=Kelly|last2=Bowman|first2=Samuel|date=2018|title=Language Modeling Teaches You More than Translation Does: Lessons Learned Through Auxiliary Syntactic Task Analysis|journal=Proceedings of the 2018 EMNLP Workshop BlackboxNLP: Analyzing and Interpreting Neural Networks for NLP|pages=359\u2013361|location=Stroudsburg, PA, USA|publisher=Association for Computational Linguistics|doi=10.18653/v1/w18-5448|doi-access=free}}</ref> and the relationships represented by [[Transformer (machine learning model)#Architecture|attention]] weights.<ref name=\":1\" /><ref name=\":2\" />\n\nThe high performance of the BERT model could also be attributed{{Cn|date=July 2024}} to the fact that it is bidirectionally trained. This means that BERT, based on the Transformer model architecture, applies its self-attention mechanism to learn information from a text from the left and right side during training, and consequently gains a deep understanding of the context. For example, the word ''fine'' can have two different meanings depending on the context ('''I feel''' fine '''today''', '''She has''' fine '''blond hair'''). BERT considers the words surrounding the target word ''fine'' from the left and right side.\n\nHowever it comes at a cost: due to [[Transformer_(deep_learning_architecture)#encoder-only|encoder-only]] architecture lacking a decoder, BERT can't [[Prompt engineering|be prompted]] and can't [[Natural language generation|generate text]], while bidirectional models in general do not work effectively without the right side, thus being difficult to prompt. As an illustrative example, if one wishes to use BERT to continue a sentence fragment \"Today, I went to\", then naively one would mask out all the tokens as \"Today, I went to  <code>[MASK]</code>  <code>[MASK]</code>  <code>[MASK]</code> ...  <code>[MASK]</code> .\" where the number of  <code>[MASK]</code>  is the length of the sentence one wishes to extend to. However, this constitutes a dataset shift, as during training, BERT has never seen sentences with that many tokens masked out. Consequently, its performance degrades. More sophisticated techniques allow text generation, but at a high computational cost.<ref>{{cite arXiv |eprint=2209.14500 |class=cs.LG |first1=Ajay |last1=Patel |first2=Bryan |last2=Li |title=Bidirectional Language Models Are Also Few-shot Learners |author3=Mohammad Sadegh Rasooli |last4=Constant |first4=Noah |last5=Raffel |first5=Colin |last6=Callison-Burch |first6=Chris |year=2022}}</ref>\n\n== History ==\n\nBERT was originally published by Google researchers Jacob Devlin, Ming-Wei Chang, Kenton Lee, and Kristina Toutanova. The design has its origins from pre-training contextual representations, including [[Semi-supervised learning|semi-supervised sequence learning]],<ref>{{cite arXiv |last1=Dai |first1=Andrew |last2=Le | first2=Quoc |title=Semi-supervised Sequence Learning |date=4 November 2015 |eprint=1511.01432|class=cs.LG }}</ref> generative pre-training, [[ELMo]],<ref>{{cite arXiv |last1=Peters |first1=Matthew |last2=Neumann | first2=Mark |last3=Iyyer | first3=Mohit |last4=Gardner | first4=Matt | last5=Clark | first5=Christopher | last6=Lee | first6=Kenton | last7=Luke | first7= Zettlemoyer |title=Deep contextualized word representations |date=15 February 2018 |eprint=1802.05365v2|class=cs.CL }}</ref> and ULMFit.<ref>{{cite arXiv |last1=Howard |first1=Jeremy |last2=Ruder | first2=Sebastian |title=Universal Language Model Fine-tuning for Text Classification |date=18 January 2018 |eprint=1801.06146v5|class=cs.CL }}</ref> Unlike previous models, BERT is a deeply bidirectional, [[Unsupervised learning|unsupervised]] language representation, pre-trained using only a plain [[text corpus]]. Context-free models such as [[word2vec]] or [[GloVe (machine learning)|GloVe]] generate a single word embedding representation for each word in the vocabulary, whereas BERT takes into account the context for each occurrence of a given word. For instance, whereas the vector for \"running\" will have the same word2vec vector representation for both of its occurrences in the sentences \"He is running a company\" and \"He is running a marathon\", BERT will provide a contextualized embedding that will be different according to the sentence.<ref name=\":5\" />\n\nOn October 25, 2019, [[Google]] announced that they had started applying BERT models for [[English language]] [[Google Search|search queries]] within the [[US]].<ref>{{cite web |last1=Nayak |first1=Pandu |title=Understanding searches better than ever before |url=https://www.blog.google/products/search/search-language-understanding-bert/ |website=Google Blog |date=25 October 2019 |access-date=10 December 2019}}</ref> On December 9, 2019, it was reported that BERT had been adopted by Google Search for over 70 languages.<ref>{{Cite web |date=2019-10-25 |title=Understanding searches better than ever before |url=https://blog.google/products/search/search-language-understanding-bert/ |access-date=2024-08-06 |website=Google |language=en-us}}</ref><ref>{{cite web |last1=Montti |first1=Roger |title=Google's BERT Rolls Out Worldwide |url=https://www.searchenginejournal.com/google-bert-rolls-out-worldwide/339359/ |website=Search Engine Journal |date=10 December 2019 |access-date=10 December 2019}}</ref> In October 2020, almost every single English-based query was processed by a BERT model.<ref>{{Cite web|date=2020-10-15|title=Google: BERT now used on almost every English query|url=https://searchengineland.com/google-bert-used-on-almost-every-english-query-342193|access-date=2020-11-24|website=Search Engine Land}}</ref>\n\n== Variants ==\nThe BERT models were influential and inspired many variants.\n\n'''RoBERTa''' (2019)<ref>{{Cite arXiv |eprint=1907.11692 |class=cs.CL |first1=Yinhan |last1=Liu |first2=Myle |last2=Ott |title=RoBERTa: A Robustly Optimized BERT Pretraining Approach |date=2019 |last3=Goyal |first3=Naman |last4=Du |first4=Jingfei |last5=Joshi |first5=Mandar |last6=Chen |first6=Danqi |last7=Levy |first7=Omer |last8=Lewis |first8=Mike |last9=Zettlemoyer |first9=Luke |last10=Stoyanov |first10=Veselin}}</ref> was an engineering improvement. It preserves BERT's architecture (slightly larger, at 355M parameters), but improves its training, changing key hyperparameters, removing the ''next-sentence prediction'' task, and using much larger [[Stochastic gradient descent#Iterative method|mini-batch]] sizes. \n\n'''DistilBERT''' (2019) [[Knowledge distillation|distills]] BERT<sub>BASE</sub> to a model with just 60% of its parameters (66M), while preserving 95% of its benchmark scores.<ref>{{Citation |last1=Sanh |first1=Victor |title=DistilBERT, a distilled version of BERT: smaller, faster, cheaper and lighter |date=2020-02-29 |arxiv=1910.01108 |last2=Debut |first2=Lysandre |last3=Chaumond |first3=Julien |last4=Wolf |first4=Thomas}}</ref><ref>{{Cite web |title=DistilBERT |url=https://huggingface.co/docs/transformers/model_doc/distilbert |access-date=2024-08-05 |website=huggingface.co}}</ref> Similarly, '''TinyBERT''' (2019)<ref>{{Citation |last1=Jiao |first1=Xiaoqi |title=TinyBERT: Distilling BERT for Natural Language Understanding |date=2020-10-15 |arxiv=1909.10351 |last2=Yin |first2=Yichun |last3=Shang |first3=Lifeng |last4=Jiang |first4=Xin |last5=Chen |first5=Xiao |last6=Li |first6=Linlin |last7=Wang |first7=Fang |last8=Liu |first8=Qun}}</ref> is a distilled model with just 28% of its parameters.\n\n'''ALBERT''' (2019)<ref>{{Citation |last1=Lan |first1=Zhenzhong |title=ALBERT: A Lite BERT for Self-supervised Learning of Language Representations |date=2020-02-08 |arxiv=1909.11942 |last2=Chen |first2=Mingda |last3=Goodman |first3=Sebastian |last4=Gimpel |first4=Kevin |last5=Sharma |first5=Piyush |last6=Soricut |first6=Radu}}</ref> used shared-parameter across layers, and experimented with independently varying the hidden size and the word-embedding layer's output size as two hyperparameters. They also replaced the ''next sentence prediction'' task with the ''sentence-order prediction'' (SOP) task, where the model must distinguish the correct order of two consecutive text segments from their reversed order. \n\n'''ELECTRA''' (2020)<ref>{{Citation |last1=Clark |first1=Kevin |title=ELECTRA: Pre-training Text Encoders as Discriminators Rather Than Generators |date=2020-03-23 |arxiv=2003.10555 |last2=Luong |first2=Minh-Thang |last3=Le |first3=Quoc V. |last4=Manning |first4=Christopher D.}}</ref> applied the idea of [[Generative adversarial network|generative adversarial networks]] to the MLM task. Instead of masking out tokens, a small language model generates random plausible plausible substitutions, and a larger network identify these replaced tokens. The small model aims to fool the large model.\n\n=== DeBERTa ===\n'''DeBERTa''' (2020)<ref>{{Citation |last1=He |first1=Pengcheng |title=DeBERTa: Decoding-enhanced BERT with Disentangled Attention |date=2021-10-06 |arxiv=2006.03654 |last2=Liu |first2=Xiaodong |last3=Gao |first3=Jianfeng |last4=Chen |first4=Weizhu}}</ref> is a significant architectural variant, with ''disentangled attention''. Its key idea is to treat the positional and token encodings separately throughout the attention mechanism. Instead of combining the positional encoding (<math>x_{position}</math>) and token encoding (<math>x_{\\text{token}}</math>) into a single input vector (<math>x_{input} = x_{position} + x_{token}</math>), DeBERTa keeps them separate as a tuple: (<math>(x_{position}, x_{token})</math>). Then, at each self-attention layer, DeBERTa computes three distinct attention matrices, rather than the single attention matrix used in BERT:{{NoteTag|note=The position-to-position type was omitted by the authors for being useless.|name=name|content=content|text=text}}\n\n{| class=\"wikitable\"\n|+ \n! Attention type \n! Query type\n! Key type\n! Example\n|-\n| Content-to-content \n| Token\n| Token\n| \"European\"; \"Union\", \"continent\" \n|-\n| Content-to-position\n| Token\n| Position\n| [adjective]; +1, +2, +3 \n|-\n| Position-to-content\n| Position\n| Token\n| -1; \"not\", \"very\" \n|}\nThe three attention matrices are added together element-wise, then passed through a softmax layer and multiplied by a projection matrix.\n\nAbsolute position encoding is included in the final self-attention layer as additional input. \n\n== Notes ==\n{{reflist|group=note}}\n\n== References ==\n{{reflist}}\n\n== Further reading ==\n* {{cite arXiv |title=A Primer in BERTology: What we know about how BERT works |first1=Anna |last1=Rogers |first2=Olga |last2=Kovaleva |first3=Anna |last3=Rumshisky |year=2020 |class=cs.CL |eprint=2002.12327 }}\n\n== External links ==\n* [https://github.com/google-research/bert Official GitHub repository]\n\n{{Google AI}}\n{{Google LLC}}\n{{Natural Language Processing}}\n{{Artificial intelligence navbox}}\n\n[[Category:Google software]]\n[[Category:Large language models]]"}