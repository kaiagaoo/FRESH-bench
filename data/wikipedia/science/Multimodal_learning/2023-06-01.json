{"title": "Multimodal learning", "page_id": 46975535, "revision_id": 1150151317, "revision_timestamp": "2023-04-16T16:04:23Z", "content": "{{Short description|Machine learning methods using multiple input modalities}}\n{{multiple issues|\n{{more footnotes|date=June 2015}}\n{{technical|date=June 2015}}\n{{tone|date=June 2015}}\n}}\n{{machine learning}}\n<!--- Don't mess with this line! ---><!--- Write your article below this line --->\n'''Multimodal learning''' attempts to model the combination of different [[Modality (human\u2013computer interaction)|modalities]] of data, often arising in real-world applications. An example of multi-modal data is data that combines text (typically represented as discrete word count vectors) with imaging data consisting of [[pixel]] intensities and annotation tags. As these modalities have fundamentally different statistical properties, combining them is non-trivial, which is why specialized modelling strategies and algorithms are required.\n\n==Motivation==\nMany models and algorithms have been implemented to retrieve and classify a certain type of data, e.g. image or text (where humans who interact with machines can extract images in a form of pictures and text that could be any message etc.). However, data usually comes with different modalities (it is the degree to which a system's components may be separated or combined) which carry different information. For example, it is very common to caption an image to convey the information not presented in the image itself. Similarly, sometimes it is more straightforward to use an image to describe the information which may not be obvious from texts. As a result, if different words appear in similar images, then these words likely describe the same thing. Conversely, if a word is used to describe seemingly dissimilar images, then these images may represent the same object. Thus, in cases dealing with multi-modal data, it is important to use a model which is able to jointly represent the information such that the model can capture the correlation structure between different modalities. Moreover, it should also be able to recover missing modalities given observed ones (e.g. predicting possible image object according to text description). The '''Multimodal Deep Boltzmann Machine model''' satisfies the above purposes.\n\n==Background: Boltzmann machine==\nA [[Boltzmann machine]] is a type of stochastic neural network invented by [[Geoffrey Hinton]] and [[Terry Sejnowski]] in 1985.  Boltzmann machines can be seen as the [[stochastic process|stochastic]], [[generative model|generative]] counterpart of [[Hopfield net]]s. They are named after the [[Boltzmann distribution]] in statistical mechanics. The units in Boltzmann machines are divided into two groups: visible units and hidden units. General Boltzmann machines allow connection between any units. However, learning is impractical using general Boltzmann Machines because the computational time is exponential to the size of the machine{{Citation needed|date=November 2022}}. A more efficient architecture is called '''[[restricted Boltzmann machine]]''' where connection is only allowed between hidden unit and visible unit, which is described in the next section.\n\n===Restricted Boltzmann machine===\nA restricted Boltzmann machine<ref>{{cite web|url=https://www.cs.cmu.edu/~bhiksha/courses/deeplearning/Fall.2014/pdfs/Smolensky.1986.pdf|title=Restricted Boltzmann Machine|year=1986|access-date=2019-08-29|archive-date=2016-03-03|archive-url=https://web.archive.org/web/20160303223045/http://www.cs.cmu.edu/~bhiksha/courses/deeplearning/Fall.2014/pdfs/Smolensky.1986.pdf|url-status=live}}</ref>  is an undirected graphical model with stochastic visible variable and stochastic hidden variables. Each visible variable is connected to each hidden variable. The energy function of the model is defined as \n:<math> E(\\mathbf v,\\mathbf h;\\theta) =  -\\sum_{i=1}^D\\sum_{j=1}^{F}W_{ij}v_ih_j -\\sum_{i=1}^Db_iv_i -\\sum_{j=1}^Fa_jh_j</math>\nwhere <math>\\theta = \\{\\mathbf v,\\mathbf h;\n\\theta\\}</math> are model parameters: <math>W_{ij}</math> represents the symmetric interaction term between visible unit <math>i</math> and hidden unit <math>j</math>; <math>b_i</math> and <math>a_j</math> are bias terms. The joint distribution of the system is defined as \n:<math> P(\\mathbf{v};\\theta) = \\frac{1}{\\mathcal{Z}(\\theta)}\\sum_{\\mathbf h}\\mathrm{exp}(-E(\\mathbf v,\\mathbf h;\\theta)) </math>\nwhere <math>\\mathcal{Z}(\\theta)</math> is a normalizing constant.\nThe conditional distribution over hidden <math>\\mathbf h</math> and <math>\\mathbf v </math> can be derived as logistic function in terms of model parameters.\n:<math>P(\\mathbf h|\\mathbf v;\\theta) = \\prod_{j=1}^Fp(h_j|\\mathbf v)</math>, with <math>p(h_j=1|\\mathbf v) = g(\\sum_{i=1}^DW_{ij}v_i + a_j)</math>\n:<math>P(\\mathbf v|\\mathbf h;\\theta) = \\prod_{i=1}^Dp(v_i|\\mathbf h)</math>, with <math>p(v_i=1|\\mathbf h) = g(\\sum_{j=1}^FW_{ij}h_j + b_i)</math>\nwhere <math>g(x) = \\frac{1}{(1+\\mathrm{exp}(-x))}</math> is the logistic function.\n \nThe derivative of the log-likelihood with respect to the model parameters can be decomposed as the difference between the ''model's expectation'' and ''data-dependent expectation''.\n\n===Gaussian-Bernoulli RBM===\n'''Gaussian-Bernoulli RBMs'''<ref>{{cite web|url=http://cseweb.ucsd.edu/~yfreund/papers/freund94unsupervised.pdf|title=Gaussian-Bernoulli RBM|year=1994|access-date=2015-06-14|archive-date=2015-07-01|archive-url=https://web.archive.org/web/20150701142108/http://cseweb.ucsd.edu/~yfreund/papers/freund94unsupervised.pdf|url-status=live}}</ref>  are a variant of restricted Boltzmann machine used for modeling real-valued vectors such as pixel intensities. It is usually used to model the image data. The energy of the system of the Gaussian-Bernoulli RBM is defined as \n:<math> E(\\mathbf v,\\mathbf h;\\theta) = \\sum_{i=1}^D\\frac{(v_i-b_i)^2}{2\\sigma_i^2} -\\sum_{i=1}^D\\sum_{j=1}^{F}\\frac{v_i}{\\sigma_i}W_{ij}v_ih_j -\\sum_{i=1}^Db_iv_i -\\sum_{j=1}^Fa_jh_j</math>\nwhere <math>\\theta = \\{\\mathbf a,\\mathbf b,\\mathbf w,\\mathbf \\sigma\\}</math> are the model parameters. The joint distribution is defined the same as the one in [[#Restricted Boltzmann machine|restricted Boltzmann machine]]. The conditional distributions now become \n:<math>P(\\mathbf h|\\mathbf v;\\theta) = \\prod_{j=1}^Fp(h_j|\\mathbf v)</math>, with <math>p(h_j=1|\\mathbf v) = g(\\sum_{i=1}^DW_{ij}\\frac{v_i}{\\sigma_i} + a_j)</math>\n:<math>P(\\mathbf v|\\mathbf h;\\theta) = \\prod_{i=1}^Dp(v_i|\\mathbf h)</math>, with <math>p(v_i|\\mathbf h) \\sim \\mathcal{N}(\\sigma_i\\sum_{j=1}^FW_{ij}h_j + b_i,\\sigma_i^2)</math>\nIn Gaussian-Bernoulli RBM, the visible unit conditioned on hidden units is modeled as a Gaussian distribution.\n\n===Replicated Softmax Model===\nThe '''Replicated Softmax Model'''<ref>{{cite web|url=http://papers.nips.cc/paper/3856-replicated-softmax-an-undirected-topic-model.pdf|title=Replicated Softmax Model|year=2009a|access-date=2015-06-14|archive-date=2015-10-01|archive-url=https://web.archive.org/web/20151001154255/http://papers.nips.cc/paper/3856-replicated-softmax-an-undirected-topic-model.pdf|url-status=live}}</ref> is also an variant of restricted Boltzmann machine and commonly used to model word count vectors in a document. In a typical [[text mining]] problem, let <math>K</math> be the dictionary size, and <math>M</math> be the number of words in the document. Let <math>\\mathbf V</math> be a <math>M \\times K</math> binary matrix with <math>v_{ik} = 1</math> only when the <math>i^{th}</math> word in the document is the <math>k^{th}</math> word in the dictionary. <math>\\hat v_k</math> denotes the count for the <math>k^{th}</math> word in the dictionary. The energy of the state <math>\\{\\mathbf V,\\mathbf h\\}</math> for a document contains <math>M</math> words is defined as\n:<math>E(\\mathbf V,\\mathbf h) = -\\sum_{j=1}^{F}\\sum_{k=1}^{K}W_{jk}\\hat v_kh_j - \\sum_{k=1}^Kb_k\\hat v_k - M\\sum_{j=1}^{F}a_jh_j</math>\nThe conditional distributions are given by \n:<math>p(h_j=1|\\mathbf V) = g(Ma_j + \\sum_{k=1}^K\\hat v_kW_{jk})</math>\n:<math>p(v_{ik} = 1|\\mathbf h) = \\frac{\\mathrm{exp}(b_k + \\sum_{j=1}^Fh_jW_{jk}}{\\sum_{q=1}^{K}\\mathrm{exp}(b_q + \\sum_{j=1}^Fh_jW_{jq}})</math>\n\n==Deep Boltzmann machines==\nA '''deep Boltzmann machine'''<ref>{{cite web|url=http://www.utstat.toronto.edu/~rsalakhu/papers/dbm.pdf|title=Deep Boltzmann Machine|year=2009b|access-date=2015-06-14|archive-date=2016-03-10|archive-url=https://web.archive.org/web/20160310102345/http://www.utstat.toronto.edu/~rsalakhu/papers/dbm.pdf|url-status=live}}</ref> has a sequence of layers of hidden units.There are only connections between adjacent hidden layers, as well as between visible units and hidden units in the first hidden layer. The energy function of the system adds layer interaction terms to the energy function of general restricted Boltzmann machine and is defined by \n<math>\n\\begin{align} \nE({\\mathbf v, \\mathbf h; \\theta} )  = & -\\sum_{i=1}^D\\sum_{j=1}^{F_1}W_{ij}^{(1)}v_ih_j^{(1)} -\\sum_{j=1}^{F_1}\\sum_{l=1}^{F_2}W_{jl}^{(2)}h_j^{(1)}h_{l}^{(2)}\\\\ \n& -\\sum_{l=1}^{F_2}\\sum_{p=1}^{F_3}W_{lp}^{(3)}h_l^{(2)}h_p^{(3)}\n - \\sum_{i = 1}^Db_iv_i - \\sum_{j=1}^{F_1}b_j^{(1)}h_j^{(1)} - \\sum_{l=1}^{F_2}b_l^{(2)}h_l^{(2)} - \\sum_{p=1}^{F_3}b_p^{(3)}h_p^{(3)}\n\\end{align}\n</math>\n\nThe joint distribution is \n:<math>P(\\mathbf{v};\\theta) = \\frac{1}{\\mathcal{Z}(\\theta)}\\sum_{\\mathbf h}\\mathrm{exp}(-E(\\mathbf v,\\mathbf h^{(1)},\\mathbf h^{(2)},\\mathbf h^{(3)};\\theta))</math>\n\n==Multimodal deep Boltzmann machines==\n'''Multimodal deep Boltzmann machine'''<ref>{{cite web|url=http://papers.nips.cc/paper/4683-multimodal-learning-with-deep-boltzmann-machines.pdf|title=Multimodal Learning with Deep Boltzmann Machine|year=2012|access-date=2015-06-14|archive-date=2016-03-04|archive-url=https://web.archive.org/web/20160304223211/http://papers.nips.cc/paper/4683-multimodal-learning-with-deep-boltzmann-machines.pdf|url-status=live}}</ref><ref>{{cite web|url=http://www.jmlr.org/papers/volume15/srivastava14b/srivastava14b.pdf|title=Multimodal Learning with Deep Boltzmann Machine|year=2014|access-date=2015-06-14|archive-date=2015-06-21|archive-url=https://web.archive.org/web/20150621055730/http://jmlr.org/papers/volume15/srivastava14b/srivastava14b.pdf|url-status=live}}</ref> uses an image-text bi-modal DBM where the image pathway is modeled as Gaussian-Bernoulli DBM and text pathway as Replicated Softmax DBM, and each DBM has two hidden layers and one visible layer. The two DBMs join together at an additional top hidden layer. The joint distribution over the multi-modal inputs defined as \n<math>\n\\begin{align}\nP(\\mathbf v^m,\\mathbf v^t;\\theta) & =  \\sum_{\\mathbf h^{(2m)},\\mathbf h^{(2t)},\\mathbf h^{(3)}}P(\\mathbf h^{(2m)},\\mathbf h^{(2t)},\\mathbf h^{(3)})(\\sum_{\\mathbf h^{(1m)}}P(\\mathbf v_m,\\mathbf h^{(1m)}|\\mathbf h^{(2m)}))(\\sum_{\\mathbf h^{(1t)}}P(\\mathbf v^t,\\mathbf h^{(1t)}|\\mathbf h^{(2t)}))\\\\\n& =  \\frac{1}{\\mathcal{Z}_M(\\theta)}\\sum_{\\mathbf h}\\mathrm{exp}(\\sum_{kj}W_{kj}^{(1t)}v_k^th_j^{(1t)} \\\\\n&+ \\sum_{jl}W_{jl}^{(2t)}h_j^{(1t)}h_l^{(2t)}+\\sum_kb_k^tv_k^t+M\\sum_jb_j^{(1t)}h_j^{(1t)}+\\sum_lb_l^{(2t)}h_l^{(2t)}\\\\\n& -  \\sum_i\\frac{(v_i^m-b_i^m)^2}{2\\sigma^2} + \\sum_{ij}\\frac{v_i^m}{\\sigma_i}W_{ij}^{(1m)}h_j^{(1m)} \\\\\n&+ \\sum_{jl}W_{jl}^{(2m)}h_j^{(1m)}h_l^{(2m)}+\\sum_jb_j^{(1m)}h_j^{(1m)}+\\sum_lb_l^{(2m)}h_l{(2m)}\\\\\n& + \\sum_{lp}W^{(3t)}h_l^{(2t)}h_p^{(3)} + \\sum_{lp}W^{(3m)}h_l^{(2m)}h_p^{(3)} + \\sum_pb_p^{(3)}h_p^{(3)}\n\\end{align}\n</math>\n\nThe conditional distributions over the visible and hidden units are \n:<math>p(h_j^{(1m)}=1|\\mathbf v^m,\\mathbf h^{(2m)}) =  g(\\sum_{i=1}^DW_{ij}^{(1m)}\\frac{v_i^m}{\\sigma_i} + \\sum_{l=1}^{F_2^m}W_{jl}^{(2m)}h_l^{(2m)}+b_j^{(1m)})</math>\n:<math>p(h_l^{(2m)}=1|\\mathbf h^{(1m)},\\mathbf h^{(3)})  =  g(\\sum_{j=1}^{F_1^m}W_{jl}^{(2m)}h_j^{(1m)} + \\sum_{p=1}^{F_3}W_{lp}^{(3m)}h_p^{(3)}+b_l^{(2m)})</math>\n:<math>p(h_j^{(1t)}=1|\\mathbf v^t,\\mathbf h^{(2t)})  =  g(\\sum_{k=1}^{K}W_{kl}^{(1t)}v_k^{(t)} + \\sum_{l=1}^{F_2^t}W_{jl}^{(2t)}h_l^{(2t)}+Mb_j^{(1t)})</math>\n:<math>p(h_l^{(2t)}=1|\\mathbf h^{(1t)},\\mathbf h^{(3)})  =  g(\\sum_{j=1}^{F_1^t}W_{jl}^{(2t)}h_j^{(1t)} + \\sum_{p=1}^{F_3}W_{lp}^{(3t)}h_p^{(3)}+b_l^{(2t)})</math>\n:<math>p(h_p^{3)}=1|\\mathbf h^{(2)})  =  g(\\sum_{l=1}^{F_2^m}W_{lp}^{(3m)}h_l^{(2m)} + \\sum_{l=1}^{F_2^t}W_{lp}^{(3t)}h_l^{(2t)}+b_p^{(3)})</math>\n:<math>p(v_{ik}^t = 1|\\mathbf h^{(1t)})  =  \\frac{\\mathrm{exp}(\\sum_{j=1}^{F_1^t}h_j^{(1t)}W_{jk}^{(1t)} + b_k^t)}{\\sum_{q=1}^K\\mathrm{exp}(\\sum_{j=1}^{F_1^t}h_j^{(1t)}W_{jq}^{(1t)} + b_k^t)}</math>\n:<math>p(v_i^m|\\mathbf h^{(1m)})  \\sim  \\mathcal{N}(\\sigma_i\\sum_{j=1}^{F_1^m}W_{ij}^{(1m)}h_j^{(1m)} + b_i^m,\\sigma_i^2)</math>\n\n===Inference and learning===\nExact maximum likelihood learning in this model is intractable, but approximate learning of DBMs can be carried out by using a variational approach, where mean-field inference is used to estimate data-dependent expectations and an MCMC based stochastic approximation procedure is used to approximate the model\u2019s expected sufficient statistics.<ref>{{cite web\n|url=http://icml2008.cs.helsinki.fi/papers/638.pdf\n|title=Approximations to the Likelihood Gradient\n|year=2008\n|access-date=2015-06-14\n|archive-date=2016-03-04\n|archive-url=https://web.archive.org/web/20160304034828/http://icml2008.cs.helsinki.fi/papers/638.pdf\n|url-status=live\n}}</ref>\n\n==Application==\nMultimodal deep Boltzmann machines are successfully used in classification and missing data retrieval. The classification accuracy of multimodal deep Boltzmann machine outperforms [[support vector machine]]s, [[latent Dirichlet allocation]] and [[deep belief network]], when models are tested on data with both image-text modalities or with single modality.{{Citation needed|date=November 2022}} Multimodal deep Boltzmann machine is also able to predict missing modalities given the observed ones with reasonably good precision.{{Citation needed|date=November 2022}} Self Supervised Learning brings a more interesting and powerful model for multimodality. [[OpenAI]] developed CLIP and [[DALL-E]] models that revolutionized multimodality.\n\nMultimodal deep learning is used for [[cancer screening]] \u2013 at least one system under development [[Data integration#Medicine and Life Sciences|integrates]] such different types of data.<ref>{{cite news |last1=Quach |first1=Katyanna |title=Harvard boffins build multimodal AI system to predict cancer |url=https://www.theregister.com/2022/08/09/ai_cancer_multimodal/ |access-date=16 September 2022 |work=The Register |language=en |archive-date=20 September 2022 |archive-url=https://web.archive.org/web/20220920163859/https://www.theregister.com/2022/08/09/ai_cancer_multimodal/ |url-status=live }}</ref><ref>{{cite journal |last1=Chen |first1=Richard J. |last2=Lu |first2=Ming Y. |last3=Williamson |first3=Drew F. K. |last4=Chen |first4=Tiffany Y. |last5=Lipkova |first5=Jana |last6=Noor |first6=Zahra |last7=Shaban |first7=Muhammad |last8=Shady |first8=Maha |last9=Williams |first9=Mane |last10=Joo |first10=Bumjin |last11=Mahmood |first11=Faisal |title=Pan-cancer integrative histology-genomic analysis via multimodal deep learning |journal=Cancer Cell |date=8 August 2022 |volume=40 |issue=8 |pages=865\u2013878.e6 |doi=10.1016/j.ccell.2022.07.004 |pmid=35944502 |s2cid=251456162 |language=English |issn=1535-6108|doi-access=free }}\n* Teaching hospital press release: {{cite news |title=New AI technology integrates multiple data types to predict cancer outcomes |url=https://medicalxpress.com/news/2022-08-ai-technology-multiple-cancer-outcomes.html |access-date=18 September 2022 |work=[[Brigham and Women's Hospital]] via medicalxpress.com |language=en |archive-date=20 September 2022 |archive-url=https://web.archive.org/web/20220920172825/https://medicalxpress.com/news/2022-08-ai-technology-multiple-cancer-outcomes.html |url-status=live }}</ref>\n\n==See also==\n*[[Hopfield network]]\n*[[Markov random field]]\n*[[Markov chain Monte Carlo]]\n\n==References==\n{{reflist}}\n\n<!--- After listing your sources please cite them using inline citations and place them after the information they cite. Please see http://en.wikipedia.org/wiki/Wikipedia:REFB for instructions on how to add citations. --->\n\n<!--- STOP! Be warned that by using this process instead of Articles for Creation, this article is subject to scrutiny. As an article in \"mainspace\", it will be DELETED if there are problems, not just declined. If you wish to use AfC, please return to the Wizard and continue from there. --->\n\n[[Category:Artificial neural networks]]\n[[Category:Multimodal interaction]]"}